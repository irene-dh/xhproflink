Please see comments at the beginning of the source code.
